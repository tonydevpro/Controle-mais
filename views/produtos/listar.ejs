<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Lista de Produtos</title>
  <link rel="stylesheet" href="/css/global.css" />
  <link rel="stylesheet" href="/css/lista.css" />
  <link rel="stylesheet" href="/css/header.css" />
</head>
<body>

    <%- include('../partials/header', { usuario: usuario }) %>

    <div class="pagina-lista">

    

  <h1>Produtos</h1>

  <a href="/produtos/adicionar">Adicionar Produto</a>
    <a href="/movimentacoes">Histórico de Movimentações</a>
    <br>
    <br>
    <form action="/produtos/importar" method="POST" enctype="multipart/form-data">
  <input type="file" name="arquivo" accept=".csv" required />
  <button type="submit">Importar Produtos</button>
</form>
<div class="exemploImportar">
  <p>Exemplo de arquivo CSV para importação:</p>
  <a href="/css/img/modelo_produtos.csv">Modelo para Importação</a>
  
  <p>Certifique-se de que o arquivo CSV esteja no formato correto.</p>
  <p>O arquivo deve conter as colunas: nome, preco_custo, preco_venda e quantidade.</p>
</div>


    <br/><br/>
    <h2>Lista de Produtos</h2>
    <p>Total de produtos: <strong><%= produtos.length %></strong></p>
    <p>Produtos com estoque baixo: <strong><%= produtos.filter(p => p.quantidade <= 5).length %></strong></p>
    <p>Produtos com estoque zerado: <strong><%= produtos.filter(p => p.quantidade === 0).length %></strong></p>
    <p>Produtos com estoque acima de 5: <strong><%= produtos.filter(p => p.quantidade > 5).length %></strong></p>
    <p>Produtos com estoque acima de 10: <strong><%= produtos.filter(p => p.quantidade > 10).length %></strong></p>


  <ul>
    <% produtos.forEach(produto => { %>
      <li>
        <strong><%= produto.nome %>
        </strong> - R$ <%= Number (produto.preco_venda).toFixed(2) %> 
        <strong><%= produto.quantidade %></strong>
        [<a href="/produtos/editar/<%= produto.id %>">Editar</a>]
        <form action="/produtos/excluir/<%= produto.id %>" method="POST" style="display:inline;">
          <button type="submit" onclick="return confirm('Quer mesmo deletar?')">Excluir</button>
        </form>
      </li>
    <% }) %>
  </ul>
</div>
  <%- include('../partials/footer.ejs') %>

</body>
</html>
